<template>
  <div
    class="flex w-20 h-20.5 items-center justify-center bg-ternary rounded border-2 hover:border-blue-100 border-blue-blue border-dashed"
  >
    <label
      class="w-20 h-20 flex flex-col align-middle justify-center items-center bg-secondary rounded tracking-wide border-1 border-green-green border-dashed cursor-pointer hover:bg-secondary-blue"
    >
      <div v-if="url" class="relative overflow-hidden"> 
        <img class="w-20 h-20" :src="url" />
        <span @click="removeFile" class="absolute w-full py-2.5 bottom-0 inset-x-0 bg-blue-100 text-black text-xs text-center leading-4">REMOVE</span>
      </div>
      <svg
        v-else
        width="3rem"
        height="3rem"
        viewBox="0 0 50 45"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M50 3.1594C49.971 2.29519 49.6009 1.47764 48.9707 0.885624C48.3404 0.293607 47.5013 -0.0246777 46.637 0.000400586H3.363C2.49867 -0.0246777 1.65959 0.293607 1.02934 0.885624C0.399091 1.47764 0.0289883 2.29519 0 3.1594V6.3084C0 6.7994 1.895 6.8004 1.895 6.3084V3.1594C1.90754 2.78185 2.06916 2.42465 2.34449 2.166C2.61981 1.90736 2.9864 1.76835 3.364 1.7794H46.637C47.0146 1.76835 47.3812 1.90736 47.6565 2.166C47.9318 2.42465 48.0935 2.78185 48.106 3.1594V25.2974L44.138 22.9504C43.9251 22.8241 43.6725 22.7827 43.4304 22.8344C43.1884 22.8861 42.9747 23.0272 42.832 23.2294C42.7663 23.3283 42.7219 23.4397 42.7014 23.5566C42.681 23.6735 42.685 23.7933 42.7132 23.9086C42.7413 24.0239 42.7931 24.1321 42.8652 24.2264C42.9373 24.3207 43.0281 24.399 43.132 24.4564L48.11 27.4004V41.8414C48.0975 42.2189 47.9358 42.5762 47.6605 42.8348C47.3852 43.0934 47.0186 43.2325 46.641 43.2214H39.341V36.3014C39.3296 35.3266 39.0882 34.3683 38.6364 33.5045C38.1846 32.6407 37.5351 31.8958 36.741 31.3304L26.869 24.1744L33.232 20.7594C33.8148 20.4485 34.4675 20.2923 35.1279 20.3056C35.7883 20.3189 36.4342 20.5013 37.004 20.8354L43.127 24.4564C43.57 24.7184 44.579 23.2124 44.136 22.9504L38.013 19.3294C37.1488 18.8226 36.1691 18.546 35.1675 18.5258C34.1659 18.5057 33.1758 18.7428 32.292 19.2144L25.244 22.9964L16.787 16.8644C15.911 16.2392 14.8795 15.8675 13.8061 15.7902C12.7326 15.713 11.6585 15.9331 10.702 16.4264L1.895 20.9934V5.5174C1.895 5.0264 0 5.0254 0 5.5174V41.8404C0.0289883 42.7046 0.399091 43.5222 1.02934 44.1142C1.65959 44.7062 2.49867 45.0245 3.363 44.9994H46.636C47.5003 45.0245 48.3394 44.7062 48.9697 44.1142C49.5999 43.5222 49.97 42.7046 49.999 41.8404L50 3.1594ZM37.445 43.2204H3.363C2.9854 43.2315 2.61881 43.0924 2.34348 42.8338C2.06816 42.5752 1.90653 42.2179 1.894 41.8404V23.0254L11.617 17.9844C12.2478 17.6589 12.9561 17.5137 13.6641 17.5647C14.3721 17.6157 15.0523 17.8609 15.63 18.2734L35.581 32.7394C36.15 33.1446 36.6153 33.6784 36.939 34.2973C37.2627 34.9163 37.4358 35.6029 37.444 36.3014L37.445 43.2204Z"
          fill="#707070"
        />
        <path
          d="M39.5869 15.5128C40.671 15.5128 41.7307 15.1913 42.632 14.5891C43.5334 13.9868 44.2359 13.1308 44.6508 12.1293C45.0656 11.1278 45.1741 10.0257 44.9626 8.9625C44.7512 7.89929 44.2291 6.92266 43.4626 6.15613C42.6961 5.3896 41.7195 4.86759 40.6562 4.6561C39.593 4.44461 38.491 4.55315 37.4895 4.968C36.4879 5.38284 35.6319 6.08536 35.0297 6.98671C34.4274 7.88805 34.106 8.94775 34.106 10.0318C34.1075 11.485 34.6855 12.8781 35.7131 13.9057C36.7406 14.9332 38.1338 15.5112 39.5869 15.5128V15.5128ZM39.5869 6.37779C40.3096 6.37779 41.0161 6.59209 41.617 6.99359C42.2179 7.3951 42.6862 7.96578 42.9628 8.63346C43.2394 9.30114 43.3117 10.0358 43.1707 10.7446C43.0298 11.4535 42.6817 12.1045 42.1707 12.6156C41.6597 13.1266 41.0086 13.4746 40.2998 13.6156C39.591 13.7566 38.8563 13.6842 38.1886 13.4076C37.5209 13.1311 36.9503 12.6627 36.5488 12.0618C36.1473 11.4609 35.933 10.7545 35.933 10.0318C35.9353 9.06388 36.3212 8.13637 37.0061 7.45242C37.691 6.76847 38.619 6.38384 39.5869 6.38278V6.37779Z"
          fill="#707070"
        />
      </svg>
      <input type="file" class="hidden" @change="onChangeFile" />
    </label>
  </div>
</template>

<script lang="ts">
import { defineComponent, ref, toRef } from "vue";
export default defineComponent({
  props: {
    image: String
  },
  setup(props, context) {
    let url = ref('')

    function onChangeFile(event) {
      const file = event.target.files[0];
      url.value = URL.createObjectURL(file);
      const reader = new FileReader();
      let rawImg;
      reader.readAsDataURL(file);
      reader.onloadend = () => {
        rawImg = reader.result;
        context.emit("myFile", rawImg);
      };
      
    }

    function removeFile() {
      if (url.value.length > 1) {
        return (url.value = '');
      }
    }

    return {
      onChangeFile,
      removeFile,
      url
    };
  },
});
</script>

<style scoped></style>
